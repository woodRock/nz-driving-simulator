(function(){"use strict";const d=(a,r,e)=>-1e4+(a*256*256+r*256+e)*.1;self.onmessage=async a=>{const{url:r,segments:e}=a.data;try{const m=await(await fetch(r)).blob(),c=await createImageBitmap(m),t=c.width,i=c.height,f=new OffscreenCanvas(t,i).getContext("2d");if(!f)throw new Error("Could not get OffscreenCanvas context");f.drawImage(c,0,0);const g=f.getImageData(0,0,t,i).data,l=new Float32Array((e+1)*(e+1));for(let o=0;o<=e;o++)for(let s=0;s<=e;s++){const w=Math.floor(s/e*(t-1)),h=(Math.floor(o/e*(i-1))*t+w)*4,p=g[h],b=g[h+1],x=g[h+2];l[o*(e+1)+s]=d(p,b,x)}self.postMessage({heights:l},[l.buffer])}catch(n){console.error("Terrain Worker Error:",n),self.postMessage({error:n.message})}}})();
